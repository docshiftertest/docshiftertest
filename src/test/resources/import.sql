DROP SCHEMA IF EXISTS METRICS CASCADE;
CREATE SCHEMA METRICS;
CREATE TABLE IF NOT EXISTS TEST_DB_NOTIFICATION(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY, timestamp VARCHAR(500),level VARCHAR(500),task_id VARCHAR(500),message VARCHAR(500),attachments VARCHAR(500) );

CREATE TABLE IF NOT EXISTS  CHAIN_CONFIGURATION(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,DESCRIPTION VARCHAR(255),ENABLED BOOLEAN NOT NULL,ERRORMAIL_DESTINATION VARCHAR(255),ERRORMAIL_HOST VARCHAR(255),ERRORMAIL_ORIGIN VARCHAR(255),NAME VARCHAR(255),PRINTER_NAME VARCHAR(255),QUEUE_NAME VARCHAR(255),ROOT_NODE_ID BIGINT,PRIORITY INTEGER,TIMEOUT BIGINT NOT NULL,FAILURE_LEVEL VARCHAR(255),UUID UUID);
CREATE TABLE IF NOT EXISTS  GLOBAL_SETTINGS(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,DEFAULT_ERROR_FOLDER VARCHAR(255),DEFAULT_TEMP_FOLDER VARCHAR(255),MQ_QUEUE VARCHAR(255),MQ_METRICS_QUEUE VARCHAR(255),MQ_SYSTEM VARCHAR(255),MQURL VARCHAR(255),MQ_USER VARCHAR(255),MQ_USER_PASSWORD VARCHAR(255));
CREATE TABLE IF NOT EXISTS  GLOBAL_NOTIFICATION(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,NOTIFICATION_EMAIL_FROM VARCHAR(255),NOTIFICATION_EMAIL_TO VARCHAR(255),NOTIFICATION_EMAIL_USERNAME VARCHAR(255),NOTIFICATION_EMAIL_PASSWORD VARCHAR(255),NOTIFICATION_HOST VARCHAR(255),NOTIFICATION_PORT VARCHAR(255),NOTIFICATION_SECURITY_OPTION VARCHAR(255),LICENSE_DAYS_BEFORE_EXPIRE VARCHAR(255),LICENSE_TIME_INTERVAL VARCHAR(255),LAST_DATE_NOTIFICATION_CHECK VARCHAR(255));
CREATE TABLE IF NOT EXISTS  MODULE(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,CLASSNAME VARCHAR(255),CONDITION VARCHAR(255),DESCRIPTION VARCHAR(255),INPUT_FILETYPE VARCHAR(255),NAME VARCHAR(255),OUTPUT_FILE_TYPE VARCHAR(255),TYPE VARCHAR(255),CODE VARCHAR(255),CONSTRAINT UK_V5CLP8YHGI3SF4VGUA5T8HFG UNIQUE(CLASSNAME));
CREATE TABLE IF NOT EXISTS  MODULE_CONFIGURATION(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,DESCRIPTION VARCHAR(255),NAME VARCHAR(255),MODULE_ID BIGINT,UUID UUID,CONSTRAINT FKCJ8AF883FUD0FAE5AU5D2M5V8 FOREIGN KEY(MODULE_ID) REFERENCES MODULE(ID));
CREATE TABLE IF NOT EXISTS  MODULE_CONFIGURATION_PARAMETER_VALUES(MODULE_CONFIGURATION_ID BIGINT NOT NULL,PARAMETER_VALUES VARCHAR(2048),PARAMETER_VALUES_KEY BIGINT NOT NULL,PRIMARY KEY(MODULE_CONFIGURATION_ID,PARAMETER_VALUES_KEY),CONSTRAINT FKDJKXLDXH15Y06YBOAI6AS3EE6 FOREIGN KEY(MODULE_CONFIGURATION_ID) REFERENCES MODULE_CONFIGURATION(ID));
CREATE TABLE IF NOT EXISTS  MODULEPARAMS(MODULE BIGINT NOT NULL,PARAM BIGINT NOT NULL,PRIMARY KEY(MODULE,PARAM),CONSTRAINT FKBUG0SCAU9UK2GO5EJ1HDDA812 FOREIGN KEY(MODULE) REFERENCES MODULE(ID));
CREATE TABLE IF NOT EXISTS  NODE(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,MODULE_CONFIGURATION_ID BIGINT,PARENT_NODE_ID BIGINT,CONSTRAINT FKDPBXB57BGEHLAYQB30GQ252VG FOREIGN KEY(MODULE_CONFIGURATION_ID) REFERENCES MODULE_CONFIGURATION(ID),CONSTRAINT FK4WJRE833Q4WNFWWTL0YBS3WN7 FOREIGN KEY(PARENT_NODE_ID) REFERENCES NODE(ID));
CREATE TABLE IF NOT EXISTS  PARAMETER(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,DESCRIPTION VARCHAR(255),NAME VARCHAR(255),REQUIRED BOOLEAN,TYPE VARCHAR(255),VALUES_JSON VARCHAR(100000),PARAMETER_GROUP VARCHAR(255));
ALTER TABLE CHAIN_CONFIGURATION ADD CONSTRAINT FKRD92G8Q2IKCFGPPAW534S15NA FOREIGN KEY(ROOT_NODE_ID) REFERENCES NODE(ID);
ALTER TABLE MODULE_CONFIGURATION_PARAMETER_VALUES ADD CONSTRAINT FKHKLTD5YRV9N2K43SWCU80UEQW FOREIGN KEY(PARAMETER_VALUES_KEY) REFERENCES PARAMETER(ID);
ALTER TABLE MODULEPARAMS ADD CONSTRAINT FK31RJOWFN7S42R787D68QXD710 FOREIGN KEY(PARAM) REFERENCES PARAMETER(ID);
CREATE TABLE IF NOT EXISTS  QUEUE_MONITOR(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,MODULE_CONFIGURATION_ID BIGINT,DURATION BIGINT,ERROR_MESSAGE VARCHAR(255),PRIORITY INTEGER, QUEUE VARCHAR(255),STATE VARCHAR(255),SUCCESS BOOLEAN,TASK_ID VARCHAR(255),TASK_SOURCE VARCHAR(255),TIME_STAMP_STARTED BIGINT,TYPE VARCHAR(255),RECEIVER_HOST VARCHAR(255),SENDER_HOST VARCHAR(255));
CREATE TABLE IF NOT EXISTS  MONITORING_CONFIGURATION(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY, NAME VARCHAR(255));
CREATE TABLE IF NOT EXISTS  MONITORING_CONFIG_ITEM(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY, TYPE VARCHAR(31) NOT NULL, CONFIGURATION_ID BIGINT NOT NULL);
CREATE TABLE IF NOT EXISTS  MONITORING_DB_CONFIG_ITEM(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY, CONNECTION VARCHAR(255), DRIVER VARCHAR(255), PASSWORD VARCHAR(255), TABLE_NAME VARCHAR(255), DB_USER VARCHAR(255));
CREATE TABLE IF NOT EXISTS  MONITORING_SMTP_CONFIG(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY, FROM_ADDRESS VARCHAR(320), HOST VARCHAR(255), PASSWORD VARCHAR(255), PORT INTEGER NOT NULL, SSL BOOLEAN NOT NULL, USERNAME VARCHAR(320));
CREATE TABLE IF NOT EXISTS  MONITORING_MAIL_CONFIG_ITEM(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY, SMTP_CONFIGURATION_ID BIGINT);
CREATE TABLE IF NOT EXISTS  MONITORING_MAIL_ADDRESS(MAIL_CONFIGURATION_ITEM_ID BIGINT NOT NULL, EMAIL VARCHAR(320) NOT NULL);
CREATE TABLE IF NOT EXISTS  MONITORING_MAIL_TEMPLATE(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY, BODY VARCHAR(1000), TASK_ID VARCHAR(255), TITLE VARCHAR(998), MAIL_CONFIGURATION_ITEM_ID BIGINT NOT NULL);
CREATE TABLE IF NOT EXISTS  MONITORING_NOTIFICATION_LEVELS(CONFIGURATION_ITEM_ID BIGINT NOT NULL, LEVEL VARCHAR(255) NOT NULL, PRIMARY KEY(CONFIGURATION_ITEM_ID, LEVEL));
CREATE TABLE IF NOT EXISTS  MONITORING_SNMP_CONFIG_ITEM(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY, COMMUNITY VARCHAR(255), IP_ADDRESS VARCHAR(255), PORT INTEGER NOT NULL, TRAP_OID VARCHAR(255));
CREATE TABLE IF NOT EXISTS  MONITORING_WEBHOOK_CONFIG_ITEM(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY, URL VARCHAR(255));
CREATE TABLE IF NOT EXISTS  MONITORING_WEBHOOK_HEADER_PARAMS(WEBHOOK_TEMPLATE_ID BIGINT NOT NULL PRIMARY KEY, VALUE VARCHAR(1000), NAME VARCHAR(255) NOT NULL);
CREATE TABLE IF NOT EXISTS  MONITORING_WEBHOOK_TEMPLATE(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY, BODY VARCHAR(1000), TASK_ID VARCHAR(255), WEBHOOK_CONFIGURATION_ITEM_ID BIGINT);
CREATE TABLE IF NOT EXISTS  MONITORING_WEBHOOK_URL_PARAMS(WEBHOOK_TEMPLATE_ID BIGINT NOT NULL PRIMARY KEY, VALUE VARCHAR(1000), NAME VARCHAR(255) NOT NULL);
CREATE TABLE IF NOT EXISTS  MONITORING_FILTER (ID BIGINT NOT NULL, OPERATOR VARCHAR(255), SNIPPETS VARCHAR(255), SNIPPETS_COMBINATION VARCHAR(255), MONITORING_CONFIG_ITEM_ID INTEGER, PRIMARY KEY (ID));
ALTER TABLE MONITORING_CONFIG_ITEM ADD CONSTRAINT FK4CH1VQDFNV832WCRXWBR1PWBI FOREIGN KEY(CONFIGURATION_ID) REFERENCES MONITORING_CONFIGURATION(ID);
ALTER TABLE MONITORING_DB_CONFIG_ITEM ADD CONSTRAINT FK7R4EB56SK328XNDFYXAYQ8SAH FOREIGN KEY(ID) REFERENCES MONITORING_CONFIG_ITEM(ID);
ALTER TABLE MONITORING_MAIL_CONFIG_ITEM ADD CONSTRAINT FKQ3K1DYQV94RYRMCSPH6L4X4S8 FOREIGN KEY(SMTP_CONFIGURATION_ID) REFERENCES MONITORING_SMTP_CONFIG(ID);
ALTER TABLE MONITORING_MAIL_CONFIG_ITEM ADD CONSTRAINT FKFN95PYKCX7LPJC9X2JNVVXT6T FOREIGN KEY(ID) REFERENCES MONITORING_CONFIG_ITEM(ID);
ALTER TABLE MONITORING_MAIL_ADDRESS ADD CONSTRAINT FKMHQRW4X7OCI1BUXGI5V88SY1B FOREIGN KEY(MAIL_CONFIGURATION_ITEM_ID) REFERENCES MONITORING_MAIL_CONFIG_ITEM(ID);
ALTER TABLE MONITORING_MAIL_TEMPLATE ADD CONSTRAINT FKM5SONVRK2SBYD62EVTWTOOC4K FOREIGN KEY(MAIL_CONFIGURATION_ITEM_ID) REFERENCES MONITORING_MAIL_CONFIG_ITEM(ID);
ALTER TABLE MONITORING_NOTIFICATION_LEVELS ADD CONSTRAINT FK36WMJDP7QKC18MI010U8LFJ0R FOREIGN KEY(CONFIGURATION_ITEM_ID) REFERENCES MONITORING_CONFIG_ITEM(ID);
ALTER TABLE MONITORING_SNMP_CONFIG_ITEM ADD CONSTRAINT FK652HW5IJRUPUG39FSHXXL8JUL FOREIGN KEY(ID) REFERENCES MONITORING_CONFIG_ITEM(ID);
ALTER TABLE MONITORING_WEBHOOK_CONFIG_ITEM ADD CONSTRAINT FK6XI79LJCYRCGH5I3RJMPKJQ1U FOREIGN KEY(ID) REFERENCES MONITORING_CONFIG_ITEM(ID);
ALTER TABLE MONITORING_WEBHOOK_HEADER_PARAMS ADD CONSTRAINT FKE4M22ROXROFRDXF4LEPJK5GME FOREIGN KEY(WEBHOOK_TEMPLATE_ID) REFERENCES MONITORING_WEBHOOK_TEMPLATE(ID);
ALTER TABLE MONITORING_WEBHOOK_TEMPLATE ADD CONSTRAINT FKGAD4F35BPR3YOWL3MCVE8GVTA FOREIGN KEY(WEBHOOK_CONFIGURATION_ITEM_ID) REFERENCES MONITORING_WEBHOOK_CONFIG_ITEM(ID);
ALTER TABLE MONITORING_WEBHOOK_URL_PARAMS ADD CONSTRAINT FKKAPT5H9EMIYDD5V6B8HSJTYTX FOREIGN KEY(WEBHOOK_TEMPLATE_ID) REFERENCES MONITORING_WEBHOOK_TEMPLATE(ID);
ALTER TABLE MONITORING_FILTER ADD CONSTRAINT FKFAMASXXM5HMD89THV406T0U9W FOREIGN KEY (MONITORING_CONFIG_ITEM_ID) REFERENCES MONITORING_CONFIG_ITEM;

INSERT INTO GLOBAL_SETTINGS (DEFAULT_ERROR_FOLDER, DEFAULT_TEMP_FOLDER, MQ_QUEUE, MQ_METRICS_QUEUE, MQ_SYSTEM, MQURL, MQ_USER, MQ_USER_PASSWORD) VALUES ('target/test-classes/ds/error', 'target/test-classes/ds/work', 'docshifter', 'dsmetrics', 'amqp', 'tcp://localhost:61616', 'docshifter', 'docshifter');

INSERT INTO GLOBAL_NOTIFICATION VALUES(1,'','','','','','','','','','');